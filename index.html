from pyrogram import Client, filters from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton, CallbackQuery, Message

app = Client("accounts_mini_app", bot_token="YOUR_BOT_TOKEN", api_id=12345, api_hash="your_api_hash")

بيانات الحسابات النموذجية

accounts = [ {"name": "PUBG Global", "category": "ألعاب", "app": "PUBG", "price": 2.5, "id": 1}, {"name": "Instagram Pro", "category": "تواصل اجتماعي", "app": "Instagram", "price": 3.0, "id": 2}, {"name": "Call of Duty", "category": "ألعاب", "app": "COD", "price": 4.0, "id": 3}, {"name": "TikTok Plus", "category": "تواصل اجتماعي", "app": "TikTok", "price": 1.2, "id": 4}, ]

categories = ["الكل", "ألعاب", "تواصل اجتماعي"]

واجهة البحث والفلاتر

@app.on_message(filters.command("start")) async def start(client, message: Message): await message.reply( "مرحبًا بك في متجر الحسابات!", reply_markup=main_menu() )

القائمة الرئيسية

def main_menu(): return InlineKeyboardMarkup([ [ InlineKeyboardButton("عرض الحسابات", callback_data="view_accounts"), InlineKeyboardButton("رفع حساب", callback_data="upload_account") ], ])

عرض الحسابات بفلترة وتصنيفات

@app.on_callback_query(filters.regex("view_accounts")) async def show_accounts(client, callback_query: CallbackQuery): await callback_query.message.edit( "اختر الفئة أو استخدم الفلتر:", reply_markup=filter_menu(show_filter=False) )

قائمة الفلاتر

def filter_menu(show_filter=False): keyboard = [ [InlineKeyboardButton(cat, callback_data=f"cat_{cat}") for cat in categories] ] if show_filter: keyboard.append([ InlineKeyboardButton("فرز حسب السعر", callback_data="sort_price"), InlineKeyboardButton("الأحدث", callback_data="sort_latest") ]) keyboard.append([ InlineKeyboardButton("إظهار/إخفاء الفلاتر", callback_data="toggle_filter") ]) keyboard.append([ InlineKeyboardButton("رجوع", callback_data="back") ]) return InlineKeyboardMarkup(keyboard)

تنفيذ الفلترة

@app.on_callback_query(filters.regex("cat_")) async def filter_by_category(client, callback_query: CallbackQuery): cat = callback_query.data.split("")[1] filtered = [acc for acc in accounts if cat == "الكل" or acc['category'] == cat] text = f"نتائج التصنيف: {cat}\n\n" if not filtered: text += "لا توجد نتائج." else: for acc in filtered: text += f"{acc['name']} ({acc['app']}) - {acc['price']}$\n/Contact{acc['id']}\n\n" await callback_query.message.edit(text, reply_markup=filter_menu())

زر إظهار وإخفاء الفلاتر

@app.on_callback_query(filters.regex("toggle_filter")) async def toggle_filters(client, callback_query: CallbackQuery): current = callback_query.message.reply_markup.inline_keyboard show_filter = not any("فرز" in btn.text for row in current for btn in row) await callback_query.message.edit("اختر الفئة أو استخدم الفلتر:", reply_markup=filter_menu(show_filter))

رفع حساب جديد

@app.on_callback_query(filters.regex("upload_account")) async def upload_account(client, callback_query: CallbackQuery): await callback_query.message.edit("أرسل بيانات الحساب بهذا الشكل:\nالاسم - القسم - التطبيق - السعر")

@app.on_message(filters.text & ~filters.command("start")) async def receive_account(client, message: Message): try: name, category, app_name, price = message.text.split(" - ") acc_id = len(accounts) + 1 accounts.append({"name": name, "category": category, "app": app_name, "price": float(price), "id": acc_id}) await message.reply("تم إضافة الحساب بنجاح!", reply_markup=main_menu()) except: await message.reply("الرجاء إرسال البيانات بالشكل الصحيح: الاسم - القسم - التطبيق - السعر")

زر تواصل مع البائع

@app.on_message(filters.command("Contact")) async def contact_seller(client, message: Message): acc_id = int(message.text.split("_")[-1]) account = next((acc for acc in accounts if acc['id'] == acc_id), None) if account: await message.reply(f"للتواصل مع البائع حول الحساب: {account['name']}\nراسلنا الآن.") else: await message.reply("لم يتم العثور على الحساب.")

app.run()

